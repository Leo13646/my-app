<!DOCTYPE html>
<html lang="zh">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Decision Engine</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}

body{
font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display",sans-serif;
background:linear-gradient(180deg,#050505,#0e0e0e);
color:#e5e7eb;
min-height:100vh;
display:flex;
flex-direction:column;
align-items:center;
padding:70px 20px;
}

.lang{
position:absolute;
top:25px;
right:35px;
font-size:13px;
color:#888;
cursor:pointer;
}

.hero{text-align:center;margin-bottom:40px;}

.hero h1{
font-size:42px;
font-weight:700;
background:linear-gradient(90deg,#fff,#bbb,#777);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}

.hero p{margin-top:10px;color:#777;font-size:14px;}

.card{
background:#0c0c0c;
border:1px solid #1f1f1f;
padding:25px;
border-radius:18px;
width:100%;
max-width:600px;
}

.label{font-size:12px;color:#777;margin:8px 0;}

input{
width:100%;
padding:10px;
border-radius:10px;
border:1px solid #222;
background:#111;
color:white;
margin-bottom:10px;
}

.result{
display:flex;
justify-content:space-between;
padding:6px 0;
font-size:13px;
border-bottom:1px solid #1a1a1a;
}

.value{font-weight:600;}
.green{color:#22c55e;}
.red{color:#ef4444;}
.yellow{color:#facc15;}
.gray{color:#9ca3af;}

button{
margin-top:15px;
width:100%;
padding:12px;
border-radius:10px;
border:none;
background:#fff;
color:#000;
font-weight:600;
cursor:pointer;
}
</style>
</head>

<body>

<div class="lang" onclick="toggleLang()">中文 / English</div>

<div class="hero">
<h1 id="title">Decision Engine</h1>
<p id="subtitle">Evaluate long-term edge before risking capital.</p>
</div>

<div class="card">

<div class="label" id="pLabel">Probability (0~1)</div>
<input type="number" id="p" step="0.01">

<div class="label" id="rLabel">Reward</div>
<input type="number" id="r">

<div class="label" id="cLabel">Cost</div>
<input type="number" id="c">

<div class="label">Bankroll (optional)</div>
<input type="number" id="bank">

<div class="result"><span id="evText">Expected Value</span><span class="value gray" id="ev">-</span></div>
<div class="result"><span>ROI</span><span class="value gray" id="roi">-</span></div>
<div class="result"><span id="beText">Break-even</span><span class="value gray" id="be">-</span></div>
<div class="result"><span id="kellyText">Kelly %</span><span class="value gray" id="kelly">-</span></div>
<div class="result"><span>Half Kelly</span><span class="value gray" id="half">-</span></div>
<div class="result"><span id="worthText">Worth</span><span class="value gray" id="worth">-</span></div>
<div class="result"><span id="riskText">Risk</span><span class="value gray" id="risk">-</span></div>

<div class="result"><span id="simProfitText">Sim Profit (100)</span><span class="value gray" id="simProfit">-</span></div>
<div class="result"><span id="simDDText">Max Drawdown</span><span class="value gray" id="simDD">-</span></div>

<button onclick="simulate()">Simulate 100 Runs</button>

</div>

<script>
let zh=false;

function toggleLang(){
zh=!zh;
title.innerText=zh?"決策引擎":"Decision Engine";
subtitle.innerText=zh?"在投入資金前先評估長期優勢":"Evaluate long-term edge before risking capital.";
pLabel.innerText=zh?"機率 (0~1)":"Probability (0~1)";
rLabel.innerText=zh?"獎勵":"Reward";
cLabel.innerText=zh?"成本":"Cost";
evText.innerText=zh?"期望值":"Expected Value";
beText.innerText=zh?"損益平衡":"Break-even";
kellyText.innerText=zh?"Kelly 比例":"Kelly %";
worthText.innerText=zh?"價值判斷":"Worth";
riskText.innerText=zh?"風險等級":"Risk";
simProfitText.innerText=zh?"模擬總盈虧":"Sim Profit (100)";
simDDText.innerText=zh?"最大回撤":"Max Drawdown";
}

document.querySelectorAll("input").forEach(i=>i.addEventListener("input",calculate));

function calculate(){
let p=parseFloat(p.value);
let r=parseFloat(r.value);
let c=parseFloat(c.value);
let bank=parseFloat(bank.value);

if(isNaN(p)||isNaN(r)||isNaN(c)){reset();return;}

let ev=p*r-c;
let roi=(ev/c)*100;
let be=c/r;
let b=(r-c)/c;
let k=(p*(b+1)-1)/b*100;

update("ev",ev);
update("roi",roi.toFixed(2)+"%");
update("be",be.toFixed(3));
update("kelly",k.toFixed(2)+"%");
update("half",(k/2).toFixed(2)+"%");

if(ev>0 && roi>20) updateText("worth","Strong Positive","green");
else if(ev>0) updateText("worth","Slight Edge","yellow");
else updateText("worth","Negative","red");

if(ev>0) updateText("risk","Low","green");
else updateText("risk","High","red");

if(!isNaN(bank) && k>0){
let stake=bank*(k/100);
update("half",(stake/2).toFixed(2));
}
}

function simulate(){
let p=parseFloat(p.value);
let r=parseFloat(r.value);
let c=parseFloat(c.value);

if(isNaN(p)||isNaN(r)||isNaN(c)){
alert("Please enter Probability, Reward and Cost.");
return;
}

let capital=0;
let peak=0;
let maxDD=0;

for(let i=0;i<100;i++){
if(Math.random()<p) capital+=r-c;
else capital-=c;

if(capital>peak) peak=capital;
let dd=peak-capital;
if(dd>maxDD) maxDD=dd;
}

update("simProfit",capital);
update("simDD",maxDD);
}

function update(id,val){
let el=document.getElementById(id);
el.innerText=val;
if(typeof val==="number"){
if(val>0) el.className="value green";
else el.className="value red";
}
}

function updateText(id,text,color){
let el=document.getElementById(id);
el.innerText=text;
el.className="value "+color;
}

function reset(){
["ev","roi","be","kelly","half","worth","risk"].forEach(id=>{
document.getElementById(id).innerText="-";
document.getElementById(id).className="value gray";
});
}
</script>

</body>
</html>
